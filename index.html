<!DOCTYPE html>
<html>
<head>
    <title>–ì–æ—Ä—å–∫–æ–≤ –ß–∞–π Lottie</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.12.2/lottie.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
        body { background: #1a1a1a; color: white; padding: 20px; }
        h1 { text-align: center; margin-bottom: 30px; color: #00ff88; }
        .upload-section { background: #2a2a2a; padding: 20px; border-radius: 10px; margin-bottom: 30px; text-align: center; }
        #fileInput { background: #3a3a3a; color: white; padding: 10px; border-radius: 5px; border: 2px dashed #00ff88; cursor: pointer; }
        .animations-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .animation-card { background: #2a2a2a; border-radius: 10px; padding: 15px; text-align: center; border: 1px solid #333; }
        .player { width: 100%; height: 200px; background: #1a1a1a; border-radius: 5px; margin-bottom: 10px; }
        .controls { display: flex; gap: 10px; justify-content: center; margin-top: 10px; }
        button { background: #00ff88; color: black; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button:hover { background: #00cc6a; }
        input[type="range"] { width: 100px; }
    </style>
</head>
<body>
    <h1>üé¨ –ì–æ—Ä—å–∫–æ–≤ –ß–∞–π Lottie</h1>
    
    <div class="upload-section">
        <h3>–ó–∞–≥—Ä—É–∑–∏ –Ω–æ–≤—É—é –∞–Ω–∏–º–∞—Ü–∏—é:</h3>
        <input type="file" id="fileInput" accept=".json">
        <p style="margin-top: 10px; color: #aaa;">–ü—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ç–∞—â–∏ .json —Ñ–∞–π–ª —Å—é–¥–∞ –∏–ª–∏ –∫–ª–∏–∫–Ω–∏</p>
    </div>
    
    <div class="animations-grid" id="animationsContainer"></div>

    <script>
        let animations = [];

        function loadAnimation(file) {
            const reader = new FileReader();
            reader.onload = function(event) {
                const animationData = JSON.parse(event.target.result);
                const animationId = 'anim_' + Date.now() + Math.random();

                const card = document.createElement('div');
                card.className = 'animation-card';
                card.innerHTML = `
                    <h4>${file.name}</h4>
                    <div class="player" id="${animationId}"></div>
                    <div class="controls">
                        <button onclick="playAnimation('${animationId}')">‚ñ∂Ô∏è –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏</button>
                        <button onclick="pauseAnimation('${animationId}')">‚è∏Ô∏è –ü–∞—É–∑–∞</button>
                        <button onclick="restartAnimation('${animationId}')">üîÑ –°–Ω–∞—á–∞–ª–∞</button>
                    </div>
                    <div style="margin-top: 10px;">
                        <label>–°–∫–æ—Ä–æ—Å—Ç—å: </label>
                        <input type="range" min="0.1" max="3" step="0.1" value="1" 
                               oninput="changeSpeed('${animationId}', this.value)">
                        <span id="speed_${animationId}">1x</span>
                    </div>
                `;
                document.getElementById('animationsContainer').appendChild(card);

                const anim = lottie.loadAnimation({
                    container: document.getElementById(animationId),
                    renderer: 'svg',
                    loop: true,
                    autoplay: true,
                    animationData: animationData
                });

                animations.push({ id: animationId, instance: anim, name: file.name });
                saveToLocalStorage(file.name, animationData);
            };
            reader.readAsText(file);
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏
        window.playAnimation = id => animations.find(a => a.id === id)?.instance.play();
        window.pauseAnimation = id => animations.find(a => a.id === id)?.instance.pause();
        window.restartAnimation = id => {
            const anim = animations.find(a => a.id === id);
            if (anim) { anim.instance.stop(); anim.instance.play(); }
        };
        window.changeSpeed = (id, speed) => {
            const anim = animations.find(a => a.id === id);
            if (anim) {
                anim.instance.setSpeed(speed);
                document.getElementById('speed_' + id).textContent = speed + 'x';
            }
        };

        // localStorage
        function saveToLocalStorage(name, data) {
            const stored = JSON.parse(localStorage.getItem('lottieAnimations') || '{}');
            stored[name] = data;
            localStorage.setItem('lottieAnimations', JSON.stringify(stored));
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
        document.getElementById('fileInput').addEventListener('change', e => {
            Array.from(e.target.files).forEach(file => { if (file.name.endsWith('.json')) loadAnimation(file); });
        });

        document.addEventListener('dragover', e => { e.preventDefault(); document.body.style.backgroundColor = '#2a2a2a'; });
        document.addEventListener('dragleave', e => { document.body.style.backgroundColor = '#1a1a1a'; });
        document.addEventListener('drop', e => {
            e.preventDefault();
            document.body.style.backgroundColor = '#1a1a1a';
            Array.from(e.dataTransfer.files).forEach(file => { if (file.name.endsWith('.json')) loadAnimation(file); });
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ localStorage
        window.addEventListener('load', () => {
            const stored = JSON.parse(localStorage.getItem('lottieAnimations') || '{}');
            Object.
